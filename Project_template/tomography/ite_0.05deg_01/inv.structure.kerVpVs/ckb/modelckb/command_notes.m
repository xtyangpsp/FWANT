%% generate anomalies
vout=inv_make_anomaly('yakutatslab2.txt',mx,my,mz,...
    [39 51 110 115 40 45 0.1],...
    [37 49 105 110 40 45 0.1],...
    [35 47 100 105 40 45 0.1],...
    [33 45 95 100 39 43 0.1],...
    [31 43 90 95 39 43 0.1],...
    [29 41 85 90 38 42 0.1],...
    [27 39 80 85 37 41 0.1],...
    [25 37 75 80 36 40 0.1],...
    [23 35 70 75 35 39 0.1],...
    [21 33 67 70 34 38 0.1],...
    [19 31 63 67 33 37 0.1],...
    [17 29 59 63 32 36 0.1]);
outmodlefile='yakutatslab3.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [39 51 110 115 41 45 0.1],...
    [37 49 105 110 41 45 0.1],...
    [35 47 100 105 41 45 0.1],...
    [33 45 95 100 40 43 0.1],...
    [31 43 90 95 40 43 0.1],...
    [29 41 85 90 39 42 0.1],...
    [27 39 80 85 38 41 0.1],...
    [25 37 75 80 37 40 0.1],...
    [23 35 70 75 36 39 0.1],...
    [21 33 67 70 35 38 0.1],...
    [19 31 63 67 34 37 0.1],...
    [17 29 59 63 33 36 0.1]);

outmodlefile='yakutatslab4.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [39 51 110 115 42 45 0.1],...
    [37 49 105 110 42 45 0.1],...
    [35 47 100 105 42 45 0.1],...
    [33 45 95 100 41 43 0.1],...
    [31 43 90 95 41 43 0.1],...
    [29 41 85 90 40 42 0.1],...
    [27 39 80 85 39 41 0.1],...
    [25 37 75 80 38 40 0.1],...
    [23 35 70 75 37 39 0.1],...
    [21 33 67 70 36 38 0.1],...
    [19 31 63 67 35 37 0.1],...
    [17 29 59 63 34 36 0.1]);

outmodlefile='yakutatslab5.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [39 51 110 115 41 45 0.1],...
    [37 49 105 110 41 45 0.1],...
    [35 47 100 105 41 45 0.1],...
    [33 45 95 100 40 43 0.1],...
    [31 43 90 95 40 43 0.1],...
    [29 41 85 90 39 42 0.1],...
    [27 39 83 85 38 41 0.1],...
    [27 39 81 83 37 40 0.1],...
    [27 39 80 81 30 40 0.1],...
    [25 37 75 80 30 41 0.1],...
    [23 35 70 75 30 40 0.1],...
    [21 33 67 70 30 40 0.1],...
    [19 31 63 67 30 38 0.1],...
    [17 29 59 63 30 36 0.1]);

outmodlefile='yakutatslab6.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [39 51 110 115 41 45 0.1],...
    [37 49 105 110 41 45 0.1],...
    [35 47 100 105 41 45 0.1],...
    [33 45 95 100 40 43 0.1],...
    [37 41 95 100 40 43 0],...
    [31 43 90 95 40 43 0.1],...
    [35 39 90 95 40 43 0],...
    [29 41 85 90 39 42 0.1],...
    [27 39 83 85 38 41 0.1],...
    [27 39 81 83 37 40 0.1],...
    [27 39 80 81 30 40 0.1],...
    [25 37 75 80 30 41 0.1],...
    [23 35 70 75 30 40 0.1],...
    [21 33 67 70 30 40 0.1],...
    [19 31 63 67 30 38 0.1],...
    [17 29 59 63 30 36 0.1]);

outmodlefile='yakutatslab7.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [39 51 110 115 41 45 0.1],...
    [37 49 105 110 41 45 0.1],...
    [35 47 100 105 41 45 0.1],...
    [33 45 95 100 40 43 0.1],...
    [37 41 95 100 40 43 0],...
    [31 43 90 95 40 43 0.1],...
    [35 39 90 95 40 43 0],...
    [29 41 85 90 39 42 0.1],...
    [27 39 83 85 38 41 0.1],...
    [27 39 81 83 37 40 0.1],...
    [27 39 80 81 30 40 0.1],...
    [25 37 75 80 30 41 0.1],...
    [23 35 70 75 30 40 0.1],...
    [21 33 67 70 30 40 0.1],...
    [19 31 63 67 30 38 0.1],...
    [17 29 59 63 30 36 0.1],...
    [41 50 95 115 34 39 -0.1]);
%% series of models to test resolution for segments C and D
outmodlefile='segmentsCD1.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [34 39 86 93 34 40 0.1],...
    [29 34 83 90 34 40 0.1],...
    [24 29 80 87 34 40 0.1],...
    [19 24 77 84 34 40 0.1],...
    [14 19 75 81 34 40 0.1],... % above are for segment D
    [34 39 73 81 34 40 0.1],...
    [29 34 70 78 34 40 0.1],...
    [24 29 67 75 34 40 0.1],...
    [19 24 64 72 34 40 0.1],...
    [14 19 61 69 34 40 0.1]);
% parallel C and D, 25-30 km apart
outmodlefile='segmentsCD2.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [30 34 87 93 34 40 0.1],...
    [27 31 85 91 34 40 0.1],...
    [24 28 83 89 34 40 0.1],...
    [21 25 82 88 34 40 0.1],...
    [18 22 80 86 34 40 0.1],... % this line and above are for segment D
    [30 34 77 83 34 40 0.1],...
    [27 31 75 81 34 40 0.1],...
    [24 28 73 79 34 40 0.1],...
    [21 25 72 78 34 40 0.1],...
    [18 22 70 76 34 40 0.1]);
% parallel C and D, 50-60 km apart
outmodlefile='segmentsCD3.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [30 34 87 93 34 40 0.1],...
    [27 31 85 91 34 40 0.1],...
    [24 28 83 89 34 40 0.1],...
    [21 25 82 88 34 40 0.1],...
    [18 22 80 86 34 40 0.1],... % this line and above are for segment D
    [30 34 75 81 34 40 0.1],...
    [27 31 73 79 34 40 0.1],...
    [24 28 71 77 34 40 0.1],...
    [21 25 70 76 34 40 0.1],...
    [18 22 68 74 34 40 0.1]);
% vertical D, sw-dipping C, 20 km at top (60-70 km deep) and 60 km at 150
% km deep.
outmodlefile='segmentsCD4.txt'; 
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [30 34 87 93 35 41 0.1],...
    [27 31 85 91 35 41 0.1],...
    [24 28 83 89 35 41 0.1],...
    [21 25 82 88 35 41 0.1],...
    [18 22 80 86 35 41 0.1],... % this line and above are for segment D
    [30 34 79 85 39 41 0.1],...
    [27 31 77 83 39 41 0.1],...
    [24 28 75 81 39 41 0.1],...
    [21 25 74 80 39 41 0.1],...
    [18 22 72 78 39 41 0.1],... %1st layer
    [30 34 77 83 37 38 0.1],...
    [27 31 75 81 37 38 0.1],...
    [24 28 73 79 37 38 0.1],...
    [21 25 72 78 37 38 0.1],...
    [18 22 70 76 37 38 0.1],...%2nd layer
    [30 34 75 81 35 36 0.1],...
    [27 31 73 79 35 36 0.1],...
    [24 28 71 77 35 36 0.1],...
    [21 25 70 76 35 36 0.1],...
    [18 22 68 74 35 36 0.1]);%3rd layer
% same as CD4 but with deeper penetration (170km) of C and narrower D.
outmodlefile='segmentsCD5.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [31 34 88 93 34 41 0.1],...
    [28 30 86 91 34 41 0.1],...
    [25 27 84 89 34 41 0.1],...
    [22 24 83 88 34 41 0.1],...
    [18 21 81 86 34 41 0.1],... % this line and above are for segment D
    [30 34 79 85 40 41 0.1],...
    [27 31 77 83 40 41 0.1],...
    [24 28 75 81 40 41 0.1],...
    [21 25 74 80 40 41 0.1],...
    [18 22 72 78 40 41 0.1],... %1st layer
    [30 34 77 83 38 39 0.1],...
    [27 31 75 81 38 39 0.1],...
    [24 28 73 79 38 39 0.1],...
    [21 25 72 78 38 39 0.1],...
    [18 22 70 76 38 39 0.1],...%2nd layer
    [30 34 75 81 36 37 0.1],...
    [27 31 73 79 36 37 0.1],...
    [24 28 71 77 36 37 0.1],...
    [21 25 70 76 36 37 0.1],...
    [18 22 68 74 36 37 0.1],...%3rd layer
    [30 34 72 78 34 35 0.1],...
    [27 31 70 76 34 35 0.1],...
    [24 28 68 74 34 35 0.1],...
    [21 25 67 73 34 35 0.1],...
    [18 22 65 71 34 35 0.1],...%4th layer
    [30 34 69 75 32 33 0.1],...
    [27 31 67 73 32 33 0.1],...
    [24 28 65 71 32 33 0.1],...
    [21 25 64 70 32 33 0.1],...
    [18 22 62 68 32 33 0.1]);%5th layer
%
outmodlefile='segmentsCD6.txt'; % not parallel, closer to real relationship
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [31 34 88 93 34 41 0.1],...
    [28 30 86 91 34 41 0.1],...
    [25 27 84 89 34 41 0.1],...
    [22 24 83 88 34 41 0.1],...
    [18 21 81 86 34 41 0.1],... % this line and above are for segment D
    [31 34 80 86 40 41 0.1],...
    [27 31 77 83 40 41 0.1],...
    [24 28 74 80 40 41 0.1],...
    [21 25 71 77 40 41 0.1],...
    [20 22 69 75 40 41 0.1],... %1st layer
    [31 34 78 84 38 39 0.1],...
    [27 31 75 81 38 39 0.1],...
    [24 28 72 78 38 39 0.1],...
    [21 25 69 75 38 39 0.1],...
    [20 22 66 73 38 39 0.1],...%2nd layer
    [31 34 76 82 36 37 0.1],...
    [27 31 73 79 36 37 0.1],...
    [24 28 70 76 36 37 0.1],...
    [21 25 67 73 36 37 0.1],...
    [20 22 65 71 36 37 0.1],...%3rd layer
    [31 34 73 79 34 35 0.1],...
    [27 31 70 76 34 35 0.1],...
    [24 28 67 73 34 35 0.1],...
    [21 25 64 70 34 35 0.1],...
    [20 22 61 68 34 35 0.1],...%4th layer
    [31 34 70 76 32 33 0.1],...
    [27 31 67 73 32 33 0.1],...
    [24 28 64 70 32 33 0.1],...
    [21 25 61 67 32 33 0.1],...
    [20 22 58 64 32 33 0.1]);%5th layer
%
outmodlefile='segmentsCD7.txt'; 
% not parallel, closer to real relationship, shorter D in N-S direction
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [31 34 88 93 34 41 0.1],...
    [28 30 86 91 34 41 0.1],...
    [25 27 84 89 34 41 0.1],...
    [22 24 83 88 34 41 0.1],... % this line and above are for segment D
    [27 31 76 83 40 41 0.1],...
    [24 28 73 80 40 41 0.1],...
    [21 25 70 77 40 41 0.1],...
    [20 22 68 75 40 41 0.1],... %1st layer
    [27 31 74 81 38 39 0.1],...
    [24 28 71 78 38 39 0.1],...
    [21 25 68 75 38 39 0.1],...
    [20 22 65 73 38 39 0.1],...%2nd layer
    [27 31 72 79 36 37 0.1],...
    [24 28 69 76 36 37 0.1],...
    [21 25 66 73 36 37 0.1],...
    [20 22 64 71 36 37 0.1],...%3rd layer
    [27 31 69 76 34 35 0.1],...
    [24 28 66 73 34 35 0.1],...
    [21 25 63 70 34 35 0.1],...
    [20 22 60 68 34 35 0.1],...%4th layer
    [27 31 66 73 32 33 0.1],...
    [24 28 63 70 32 33 0.1],...
    [21 25 60 67 32 33 0.1],...
    [20 22 57 64 32 33 0.1]);%5th layer
%% series of models to test resolution for mantle forearc
%forearc1: only low-velocity anomalies (-10%) along the entire strike
outmodlefile='forearc1.txt'; 
%
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [56 58 40 51 40 43 -0.1],...
    [53 55 45 56 40 43 -0.1],...
    [50 52 50 61 40 43 -0.1],...
    [47 49 55 65 40 43 -0.1],...
    [44 46 58 68 40 43 -0.1],...
    [41 43 60 70 40 43 -0.1],...
    [38 40 61 71 40 43 -0.1],...
    [35 37 62 72 40 43 -0.1],...
    [32 34 64 74 40 43 -0.1],...
    [29 31 66 76 40 43 -0.1],...
    [27 28 68 78 40 43 -0.1],...
    [25 26 70 80 40 43 -0.1],...
    [23 24 72 82 40 43 -0.1],...
    [21 23 74 93 40 43 -0.1],...
    [20 21 76 90 40 43 -0.1],...
    [19 19 79 86 40 43 -0.1],...
    [22 23 86 97 40 43 -0.1],...
    [23 24 87 101 40 43 -0.1],...
    [24 25 93 104 40 43 -0.1],...
    [25 26 96 107 40 43 -0.1],...
    [26 27 99 110 40 43 -0.1],...
    [27 28 102 113 40 43 -0.1],...
    [28 29 105 116 40 43 -0.1],...
    [29 30 108 118 40 43 -0.1],...
    [30 31 111 121 40 43 -0.1],...
    [31 32 114 124 40 43 -0.1],...
    [32 33 117 127 40 43 -0.1],...
    [33 34 120 130 40 43 -0.1]);
%forearc2: low-velocity (-5%) forearc, overlain by -10% low-v to simulate
%the crust
outmodlefile='forearc2.txt'; 
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [55 60 10 50 44 52 -0.1],...
    [50 55 10 59 44 52 -0.1],...
    [45 50 10 65 44 52 -0.1],...
    [40 45 10 70 44 52 -0.1],...
    [38 40 10 80 44 52 -0.1],...
    [5 37 10 150 44 52 -0.1],...
    [38 38 110 150 44 52 -0.1],...
    [39 42 119 150 44 52 -0.1],...
    [43 45 125 150 44 52 -0.1],...
    [56 58 40 51 40 43 -0.05],...
    [53 55 45 56 40 43 -0.05],...
    [50 52 50 61 40 43 -0.05],...
    [47 49 55 65 40 43 -0.05],...
    [44 46 58 68 40 43 -0.05],...
    [41 43 60 70 40 43 -0.05],...
    [38 40 61 71 40 43 -0.05],...
    [35 37 62 72 40 43 -0.05],...
    [32 34 64 74 40 43 -0.05],...
    [29 31 66 76 40 43 -0.05],...
    [27 28 68 78 40 43 -0.05],...
    [25 26 70 80 40 43 -0.05],...
    [23 24 72 82 40 43 -0.05],...
    [21 23 74 93 40 43 -0.05],...
    [20 21 76 90 40 43 -0.05],...
    [19 19 79 86 40 43 -0.05],...
    [22 23 86 97 40 43 -0.05],...
    [23 24 87 101 40 43 -0.05],...
    [24 25 93 104 40 43 -0.05],...
    [25 26 96 107 40 43 -0.05],...
    [26 27 99 110 40 43 -0.05],...
    [27 28 102 113 40 43 -0.05],...
    [28 29 105 116 40 43 -0.05],...
    [29 30 108 118 40 43 -0.05],...
    [30 31 111 121 40 43 -0.05],...
    [31 32 114 124 40 43 -0.05],...
    [32 33 117 127 40 43 -0.05],...
    [33 34 120 130 40 43 -0.05]);
%forearc3: low-velocity (-5%) forearc, overlain by -10% low-v to simulate
%the crust, and underlain by 10% slab
outmodlefile='forearc3.txt'; 
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [55 60 51 67 44 52 0.1],...
    [50 55 60 72 44 52 0.1],...
    [45 50 66 78 44 52 0.1],...
    [41 45 70 84 44 52 0.1],...
    [38 43 77 90 44 52 0.1],...
    [37 42 89 109 44 52 0.1],...
    [39 43 110 118 44 52 0.1],...%1st
    [56 58 52 65 40 43 0.1],...
    [53 55 57 69 40 43 0.1],...
    [50 52 62 74 40 43 0.1],...
    [47 49 66 78 40 43 0.1],...
    [44 46 69 81 40 43 0.1],...
    [41 43 71 83 40 43 0.1],...
    [38 41 73 86 41 43 0.1],...
    [33 37 75 88 41 43 0.1],...
    [30 36 78 105 41 43 0.1],...
    [28 30 81 100 41 43 0.1],...
    [26 27 82 95 41 43 0.1],...
    [33 38 101 114 40 43 0.1],...
    [35 40 115 120 40 43 0.1],...%2nd
    [54 56 50 63 37 39 0.1],...
    [51 53 55 67 37 39 0.1],...
    [48 50 60 72 37 39 0.1],...
    [45 47 64 76 37 39 0.1],...
    [42 44 67 79 37 39 0.1],...
    [39 41 69 81 37 39 0.1],...
    [36 39 71 84 38 40 0.1],...
    [31 35 73 86 38 40 0.1],...
    [28 34 76 103 38 40 0.1],...
    [26 28 79 98 38 40 0.1],...
    [24 25 80 93 38 40 0.1],...
    [31 36 99 112 37 39 0.1],...
    [33 38 113 118 37 39 0.1],...%3rd
    [53 55 48 61 34 36 0.1],...
    [50 52 53 65 34 36 0.1],...
    [47 49 58 70 34 36 0.1],...
    [44 46 62 74 34 36 0.1],...
    [41 43 65 77 34 36 0.1],...
    [38 40 67 79 34 36 0.1],...
    [35 38 69 82 35 37 0.1],...
    [30 34 71 84 35 37 0.1],...
    [27 33 74 101 35 37 0.1],...
    [25 27 77 96 35 37 0.1],...
    [23 24 78 91 35 37 0.1],...
    [30 35 97 110 34 36 0.1],...
    [32 37 111 116 34 36 0.1],...%4th
    [55 60 10 50 44 52 -0.1],...
    [50 55 10 59 44 52 -0.1],...
    [45 50 10 65 44 52 -0.1],...
    [40 45 10 70 44 52 -0.1],...
    [38 40 10 80 44 52 -0.1],...
    [5 37 10 150 44 52 -0.1],...
    [38 38 110 150 44 52 -0.1],...
    [39 42 119 150 44 52 -0.1],...
    [43 45 125 150 44 52 -0.1],...
    [56 58 40 51 40 43 -0.05],...
    [53 55 45 56 40 43 -0.05],...
    [50 52 50 61 40 43 -0.05],...
    [47 49 55 65 40 43 -0.05],...
    [44 46 58 68 40 43 -0.05],...
    [41 43 60 70 40 43 -0.05],...
    [38 40 61 71 40 43 -0.05],...
    [35 37 62 72 40 43 -0.05],...
    [32 34 64 74 40 43 -0.05],...
    [29 31 66 76 40 43 -0.05],...
    [27 28 68 78 40 43 -0.05],...
    [25 26 70 80 40 43 -0.05],...
    [23 24 72 82 40 43 -0.05],...
    [21 23 74 93 40 43 -0.05],...
    [20 21 76 90 40 43 -0.05],...
    [19 19 79 86 40 43 -0.05],...
    [22 23 86 97 40 43 -0.05],...
    [23 24 87 101 40 43 -0.05],...
    [24 25 93 104 40 43 -0.05],...
    [25 26 96 107 40 43 -0.05],...
    [26 27 99 110 40 43 -0.05],...
    [27 28 102 113 40 43 -0.05],...
    [28 29 105 116 40 43 -0.05],...
    [29 30 108 118 40 43 -0.05],...
    [30 31 111 121 40 43 -0.05],...
    [31 32 114 124 40 43 -0.05],...
    [32 33 117 127 40 43 -0.05],...
    [33 34 120 130 40 43 -0.05]);
%same as forearc2 but with forearc of -10%, 1 grid thinner crust
outmodlefile='forearc4.txt'; 
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [55 60 10 50 45 52 -0.1],...
    [50 55 10 59 45 52 -0.1],...
    [45 50 10 65 45 52 -0.1],...
    [40 45 10 70 45 52 -0.1],...
    [38 40 10 80 45 52 -0.1],...
    [5 37 10 150 45 52 -0.1],...
    [38 38 110 150 45 52 -0.1],...
    [39 42 119 150 45 52 -0.1],...
    [43 45 125 150 45 52 -0.1],...
    [56 58 40 51 41 44 -0.1],...
    [53 55 45 56 41 44 -0.1],...
    [50 52 50 61 41 44 -0.1],...
    [47 49 55 65 41 44 -0.1],...
    [44 46 58 68 41 44 -0.1],...
    [41 43 60 70 41 44 -0.1],...
    [38 40 61 71 41 44 -0.1],...
    [35 37 62 72 41 44 -0.1],...
    [32 34 64 74 41 44 -0.1],...
    [29 31 66 76 41 44 -0.1],...
    [27 28 68 78 41 44 -0.1],...
    [25 26 70 80 41 44 -0.1],...
    [23 24 72 82 41 44 -0.1],...
    [21 23 74 93 41 44 -0.1],...
    [20 21 76 90 41 44 -0.1],...
    [19 19 79 86 41 44 -0.1],...
    [22 23 86 97 41 44 -0.1],...
    [23 24 87 101 41 44 -0.1],...
    [24 25 93 104 41 44 -0.1],...
    [25 26 96 107 41 44 -0.1],...
    [26 27 99 110 41 44 -0.1],...
    [27 28 102 113 41 44 -0.1],...
    [28 29 105 116 41 44 -0.1],...
    [29 30 108 118 41 44 -0.1],...
    [30 31 111 121 41 44 -0.1],...
    [31 32 114 124 41 44 -0.1],...
    [32 33 117 127 41 44 -0.1],...
    [33 34 120 130 41 44 -0.1]);
%same as forearc3 but with forearc dV=-10%, 1 grid thinner crust
outmodlefile='forearc5.txt'; 
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [55 60 51 67 45 52 0.1],...
    [50 55 60 72 45 52 0.1],...
    [45 50 66 78 45 52 0.1],...
    [41 45 70 84 45 52 0.1],...
    [38 43 77 90 45 52 0.1],...
    [37 42 89 109 45 52 0.1],...
    [39 43 110 118 45 52 0.1],...%1st
    [56 58 52 65 40 44 0.1],...
    [53 55 57 69 40 44 0.1],...
    [50 52 62 74 40 44 0.1],...
    [47 49 66 78 40 44 0.1],...
    [44 46 69 81 40 44 0.1],...
    [41 43 71 83 40 44 0.1],...
    [38 41 73 86 41 44 0.1],...
    [33 37 75 88 41 44 0.1],...
    [30 36 78 105 41 44 0.1],...
    [28 30 81 100 41 44 0.1],...
    [26 27 82 95 41 44 0.1],...
    [33 38 101 114 40 44 0.1],...
    [35 40 115 120 40 44 0.1],...%2nd
    [54 56 50 63 37 39 0.1],...
    [51 53 55 67 37 39 0.1],...
    [48 50 60 72 37 39 0.1],...
    [45 47 64 76 37 39 0.1],...
    [42 44 67 79 37 39 0.1],...
    [39 41 69 81 37 39 0.1],...
    [36 39 71 84 38 40 0.1],...
    [31 35 73 86 38 40 0.1],...
    [28 34 76 103 38 40 0.1],...
    [26 28 79 98 38 40 0.1],...
    [24 25 80 93 38 40 0.1],...
    [31 36 99 112 37 39 0.1],...
    [33 38 113 118 37 39 0.1],...%3rd
    [53 55 48 61 34 36 0.1],...
    [50 52 53 65 34 36 0.1],...
    [47 49 58 70 34 36 0.1],...
    [44 46 62 74 34 36 0.1],...
    [41 43 65 77 34 36 0.1],...
    [38 40 67 79 34 36 0.1],...
    [35 38 69 82 35 37 0.1],...
    [30 34 71 84 35 37 0.1],...
    [27 33 74 101 35 37 0.1],...
    [25 27 77 96 35 37 0.1],...
    [23 24 78 91 35 37 0.1],...
    [30 35 97 110 34 36 0.1],...
    [32 37 111 116 34 36 0.1],...%4th
    [55 60 10 50 45 52 -0.1],...
    [50 55 10 59 45 52 -0.1],...
    [45 50 10 65 45 52 -0.1],...
    [40 45 10 70 45 52 -0.1],...
    [38 40 10 80 45 52 -0.1],...
    [5 37 10 150 45 52 -0.1],...
    [38 38 110 150 45 52 -0.1],...
    [39 42 119 150 45 52 -0.1],...
    [43 45 125 150 45 52 -0.1],...
    [56 58 40 51 41 44 -0.1],...
    [53 55 45 56 41 44 -0.1],...
    [50 52 50 61 41 44 -0.1],...
    [47 49 55 65 41 44 -0.1],...
    [44 46 58 68 41 44 -0.1],...
    [41 43 60 70 41 44 -0.1],...
    [38 40 61 71 41 44 -0.1],...
    [35 37 62 72 41 44 -0.1],...
    [32 34 64 74 41 44 -0.1],...
    [29 31 66 76 41 44 -0.1],...
    [27 28 68 78 41 44 -0.1],...
    [25 26 70 80 41 44 -0.1],...
    [23 24 72 82 41 44 -0.1],...
    [21 23 74 93 41 44 -0.1],...
    [20 21 76 90 41 44 -0.1],...
    [19 19 79 86 41 44 -0.1],...
    [22 23 86 97 41 44 -0.1],...
    [23 24 87 101 41 44 -0.1],...
    [24 25 93 104 41 44 -0.1],...
    [25 26 96 107 41 44 -0.1],...
    [26 27 99 110 41 44 -0.1],...
    [27 28 102 113 41 44 -0.1],...
    [28 29 105 116 41 44 -0.1],...
    [29 30 108 118 41 44 -0.1],...
    [30 31 111 121 41 44 -0.1],...
    [31 32 114 124 41 44 -0.1],...
    [32 33 117 127 41 44 -0.1],...
    [33 34 120 130 41 44 -0.1]);
%% series tests to test resolution for DVG segment with high-velocity mantle wedge corner
outmodlefile='segmentsDVG1.txt'; %sigle high-v anomaly (10%)
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [31 31 78 84 33 41 0.1],...
    [30 30 77 83 33 41 0.1],...
    [29 29 76 82 33 41 0.1],...
    [28 28 75 81 33 41 0.1],...
    [27 27 73 80 33 41 0.1],...
    [26 26 72 79 33 41 0.1],...
    [25 25 70 78 33 41 0.1],...
    [24 24 69 76 33 41 0.1],...
    [23 23 67 74 33 41 0.1],...
    [22 22 65 73 33 41 0.1],...
    [21 21 64 71 33 41 0.1],...
    [20 20 63 69 33 41 0.1]);
outmodlefile='segmentsDVG2.txt'; %two high-v anomalies: slab (5%) and DVG high wedge (10%), vertical.
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [31 31 78 84 33 41 0.05],...
    [30 30 77 83 33 41 0.05],...
    [29 29 76 82 33 41 0.05],...
    [28 28 75 81 33 41 0.05],...
    [27 27 73 80 33 41 0.05],...
    [26 26 72 79 33 41 0.05],...
    [25 25 70 78 33 41 0.05],...
    [24 24 69 76 33 41 0.1],...
    [23 23 67 74 33 41 0.1],...
    [22 22 65 73 33 41 0.1],...
    [21 21 64 71 33 41 0.1],...
    [20 20 63 69 33 41 0.1]);
outmodlefile='segmentsDVG3.txt';
%two high-v anomalies: slab (7.5%) and DVG high wedge (10%), dipping, about 45 degrees.
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [31 31 78 84 40 41 0.075],...
    [30 30 77 83 40 41 0.075],...
    [29 29 76 82 40 41 0.075],...
    [28 28 75 81 40 41 0.075],...
    [27 27 73 80 40 41 0.075],...
    [26 26 72 79 40 41 0.1],...
    [25 25 70 78 40 41 0.1],...
    [24 24 69 76 40 41 0.1],...
    [23 23 67 74 40 41 0.1],...
    [22 22 65 73 40 41 0.1],...
    [21 21 64 71 40 41 0.1],...
    [20 20 63 69 40 41 0.1],... % 1
    [31 31 78 84 38 39 0.075],...
    [30 30 77 83 38 39 0.075],...
    [29 29 76 82 38 39 0.075],...
    [28 28 75 81 38 39 0.075],...
    [27 27 73 80 38 39 0.075],...
    [26 26 72 79 38 39 0.075],...
    [25 25 70 78 38 39 0.1],...
    [24 24 69 76 38 39 0.1],...
    [23 23 67 74 38 39 0.1],...
    [22 22 65 73 38 39 0.1],...
    [21 21 64 71 38 39 0.1],...
    [20 20 63 69 38 39 0.1],... %2
    [31 31 78 84 36 37 0.075],...
    [30 30 77 83 36 37 0.075],...
    [29 29 76 82 36 37 0.075],...
    [28 28 75 81 36 37 0.075],...
    [27 27 73 80 36 37 0.075],...
    [26 26 72 79 36 37 0.075],...
    [25 25 70 78 36 37 0.075],...
    [24 24 69 76 36 37 0.1],...
    [23 23 67 74 36 37 0.1],...
    [22 22 65 73 36 37 0.1],...
    [21 21 64 71 36 37 0.1],...
    [20 20 63 69 36 37 0.1],... % 3
    [31 31 78 84 34 35 0.075],...
    [30 30 77 83 34 35 0.075],...
    [29 29 76 82 34 35 0.075],...
    [28 28 75 81 34 35 0.075],...
    [27 27 73 80 34 35 0.075],...
    [26 26 72 79 34 35 0.075],...
    [25 25 70 78 34 35 0.075],...
    [24 24 69 76 34 35 0.075],...
    [23 23 67 74 34 35 0.1],...
    [22 22 65 73 34 35 0.1],...
    [21 21 64 71 34 35 0.1],...
    [20 20 63 69 34 35 0.1],... %4
    [31 31 78 84 32 33 0.075],...
    [30 30 77 83 32 33 0.075],...
    [29 29 76 82 32 33 0.075],...
    [28 28 75 81 32 33 0.075],...
    [27 27 73 80 32 33 0.075],...
    [26 26 72 79 32 33 0.075],...
    [25 25 70 78 32 33 0.075],...
    [24 24 69 76 32 33 0.075],...
    [23 23 67 74 32 33 0.075],...
    [22 22 65 73 32 33 0.1],...
    [21 21 64 71 32 33 0.1],...
    [20 20 63 69 32 33 0.1]); % 5 layer

outmodlefile='segmentsDVG4.txt';
%two high-v anomalies: slab (5%) and DVG high wedge (10%), dipping, about 45 degrees.
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [31 31 78 84 40 41 0.05],...
    [30 30 77 83 40 41 0.05],...
    [29 29 76 82 40 41 0.05],...
    [28 28 75 81 40 41 0.05],...
    [27 27 73 80 40 41 0.05],...
    [26 26 72 79 40 41 0.1],...
    [25 25 70 78 40 41 0.1],...
    [24 24 69 76 40 41 0.1],...
    [23 23 67 74 40 41 0.1],...
    [22 22 65 73 40 41 0.1],...
    [21 21 64 71 40 41 0.1],...
    [20 20 63 69 40 41 0.1],... % 1
    [31 31 78 84 38 39 0.05],...
    [30 30 77 83 38 39 0.05],...
    [29 29 76 82 38 39 0.05],...
    [28 28 75 81 38 39 0.05],...
    [27 27 73 80 38 39 0.05],...
    [26 26 72 79 38 39 0.05],...
    [25 25 70 78 38 39 0.1],...
    [24 24 69 76 38 39 0.1],...
    [23 23 67 74 38 39 0.1],...
    [22 22 65 73 38 39 0.1],...
    [21 21 64 71 38 39 0.1],...
    [20 20 63 69 38 39 0.1],... %2
    [31 31 78 84 36 37 0.05],...
    [30 30 77 83 36 37 0.05],...
    [29 29 76 82 36 37 0.05],...
    [28 28 75 81 36 37 0.05],...
    [27 27 73 80 36 37 0.05],...
    [26 26 72 79 36 37 0.05],...
    [25 25 70 78 36 37 0.05],...
    [24 24 69 76 36 37 0.1],...
    [23 23 67 74 36 37 0.1],...
    [22 22 65 73 36 37 0.1],...
    [21 21 64 71 36 37 0.1],...
    [20 20 63 69 36 37 0.1],... % 3
    [31 31 78 84 34 35 0.05],...
    [30 30 77 83 34 35 0.05],...
    [29 29 76 82 34 35 0.05],...
    [28 28 75 81 34 35 0.05],...
    [27 27 73 80 34 35 0.05],...
    [26 26 72 79 34 35 0.05],...
    [25 25 70 78 34 35 0.05],...
    [24 24 69 76 34 35 0.05],...
    [23 23 67 74 34 35 0.1],...
    [22 22 65 73 34 35 0.1],...
    [21 21 64 71 34 35 0.1],...
    [20 20 63 69 34 35 0.1],... %4
    [31 31 78 84 32 33 0.05],...
    [30 30 77 83 32 33 0.05],...
    [29 29 76 82 32 33 0.05],...
    [28 28 75 81 32 33 0.05],...
    [27 27 73 80 32 33 0.05],...
    [26 26 72 79 32 33 0.05],...
    [25 25 70 78 32 33 0.05],...
    [24 24 69 76 32 33 0.05],...
    [23 23 67 74 32 33 0.05],...
    [22 22 65 73 32 33 0.1],...
    [21 21 64 71 32 33 0.1],...
    [20 20 63 69 32 33 0.1]); % 5 layer

outmodlefile='segmentsDVG5.txt';
%two high-v anomalies: slab (10%) and DVG mantle wedge without anomaly, slab dipping is about 45 degrees.
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [31 31 78 84 40 41 0.05],...
    [30 30 77 83 40 41 0.05],...
    [29 29 76 82 40 41 0.05],...
    [28 28 75 81 40 41 0.05],...
    [27 27 73 80 40 41 0.05],...
    [26 26 72 79 40 41 0.1],...
    [25 25 70 78 40 41 0.1],...
    [24 24 69 76 40 41 0.1],...
    [23 23 67 74 40 41 0.1],...
    [22 22 65 73 40 41 0.1],...
    [21 21 64 71 40 41 0.1],...
    [20 20 63 69 40 41 0.1],... % 1
    [31 31 78 84 38 39 0.05],...
    [30 30 77 83 38 39 0.05],...
    [29 29 76 82 38 39 0.05],...
    [28 28 75 81 38 39 0.05],...
    [27 27 73 80 38 39 0.05],...
    [26 26 72 79 38 39 0.05],...
    [25 25 70 78 38 39 0.1],...
    [24 24 69 76 38 39 0.1],...
    [23 23 67 74 38 39 0.1],...
    [22 22 65 73 38 39 0.1],...
    [21 21 64 71 38 39 0.1],...
    [20 20 63 69 38 39 0.1],... %2
    [31 31 78 84 36 37 0.05],...
    [30 30 77 83 36 37 0.05],...
    [29 29 76 82 36 37 0.05],...
    [28 28 75 81 36 37 0.05],...
    [27 27 73 80 36 37 0.05],...
    [26 26 72 79 36 37 0.05],...
    [25 25 70 78 36 37 0.05],...
    [24 24 69 76 36 37 0.1],...
    [23 23 67 74 36 37 0.1],...
    [22 22 65 73 36 37 0.1],...
    [21 21 64 71 36 37 0.1],...
    [20 20 63 69 36 37 0.1],... % 3
    [31 31 78 84 34 35 0.05],...
    [30 30 77 83 34 35 0.05],...
    [29 29 76 82 34 35 0.05],...
    [28 28 75 81 34 35 0.05],...
    [27 27 73 80 34 35 0.05],...
    [26 26 72 79 34 35 0.05],...
    [25 25 70 78 34 35 0.05],...
    [24 24 69 76 34 35 0.05],...
    [23 23 67 74 34 35 0.1],...
    [22 22 65 73 34 35 0.1],...
    [21 21 64 71 34 35 0.1],...
    [20 20 63 69 34 35 0.1],... %4
    [31 31 78 84 32 33 0.05],...
    [30 30 77 83 32 33 0.05],...
    [29 29 76 82 32 33 0.05],...
    [28 28 75 81 32 33 0.05],...
    [27 27 73 80 32 33 0.05],...
    [26 26 72 79 32 33 0.05],...
    [25 25 70 78 32 33 0.05],...
    [24 24 69 76 32 33 0.05],...
    [23 23 67 74 32 33 0.05],...
    [22 22 65 73 32 33 0.1],...
    [21 21 64 71 32 33 0.1],...
    [20 20 63 69 32 33 0.1]); % 5 layer
%%
outmodlefile='layer10km.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-3 mz 0.1],...
    [1 mx 1 my mz-6 mz-4 -0.1],...
    [1 mx 1 my mz-8 mz-7 0.1],...
    [1 mx 1 my mz-9 mz-9 -0.1],...
    [1 mx 1 my mz-10 mz-10 0.1],...
    [1 mx 1 my mz-11 mz-11 -0.1],...
    [1 mx 1 my mz-12 mz-12 0.1],...
    [1 mx 1 my mz-13 mz-13 -0.1],...
    [1 mx 1 my mz-14 mz-14 0.1],...
    [1 mx 1 my mz-15 mz-15 -0.1],...
    [1 mx 1 my mz-16 mz-16 0.1],...
    [1 mx 1 my mz-17 mz-17 -0.1],...
    [1 mx 1 my mz-18 mz-18 0.1],...
    [1 mx 1 my mz-19 mz-19 -0.1],...
    [1 mx 1 my mz-20 mz-20 0.1],...
    [1 mx 1 my mz-21 mz-21 -0.1]); % 5 layer

%%
outmodlefile='layer20km.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-6 mz 0.1],...
    [1 mx 1 my mz-9 mz-7 -0.1],...
    [1 mx 1 my mz-11 mz-10 0.1],...
    [1 mx 1 my mz-13 mz-12 -0.1],...
    [1 mx 1 my mz-15 mz-14 0.1],...
    [1 mx 1 my mz-17 mz-16 -0.1],...
    [1 mx 1 my mz-19 mz-18 0.1],...
    [1 mx 1 my mz-21 mz-20 -0.1]); % 5 layer
outmodlefile='layer20kmA.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-6 mz 0.1],...
    [1 mx 1 my mz-9 mz-7 0],...
    [1 mx 1 my mz-11 mz-10 0.1],...
    [1 mx 1 my mz-13 mz-12 0],...
    [1 mx 1 my mz-15 mz-14 0.1],...
    [1 mx 1 my mz-17 mz-16 0],...
    [1 mx 1 my mz-19 mz-18 0.1],...
    [1 mx 1 my mz-21 mz-20 0]); % 5 layer
outmodlefile='layer20kmB.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-6 mz -0.1],...
    [1 mx 1 my mz-9 mz-7 0],...
    [1 mx 1 my mz-11 mz-10 -0.1],...
    [1 mx 1 my mz-13 mz-12 0],...
    [1 mx 1 my mz-15 mz-14 -0.1],...
    [1 mx 1 my mz-17 mz-16 0],...
    [1 mx 1 my mz-19 mz-18 -0.1],...
    [1 mx 1 my mz-21 mz-20 0]); % 5 layer
outmodlefile='layer30kmA.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-8 mz 0.1],...
    [1 mx 1 my mz-11 mz-9 0],...
    [1 mx 1 my mz-14 mz-12 0.1],...
    [1 mx 1 my mz-17 mz-15 0],...
    [1 mx 1 my mz-20 mz-18 0.1],...
    [1 mx 1 my mz-23 mz-21 0]); % 5 layer
outmodlefile='layer30kmB.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-8 mz -0.1],...
    [1 mx 1 my mz-11 mz-9 0],...
    [1 mx 1 my mz-14 mz-12 -0.1],...
    [1 mx 1 my mz-17 mz-15 0],...
    [1 mx 1 my mz-20 mz-18 -0.1],...
    [1 mx 1 my mz-23 mz-21 0]); % 5 layer
outmodlefile='layer40km.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-9 mz 0.1],...
    [1 mx 1 my mz-13 mz-10 -0.1],...
    [1 mx 1 my mz-17 mz-14 0.1],...
    [1 mx 1 my mz-20 mz-18 -0.1],...
    [1 mx 1 my mz-23 mz-21 0.1]); % 5 layer
outmodlefile='layer40kmA.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-9 mz 0.1],...
    [1 mx 1 my mz-13 mz-10 0],...
    [1 mx 1 my mz-17 mz-14 0.1],...
    [1 mx 1 my mz-20 mz-18 0],...
    [1 mx 1 my mz-23 mz-21 0.1]); % 5 layer
outmodlefile='layer40kmB.txt';
vout=inv_make_anomaly(outmodlefile,mx,my,mz,...
    [1 mx 1 my mz-9 mz -0.1],...
    [1 mx 1 my mz-13 mz-10 0],...
    [1 mx 1 my mz-17 mz-14 -0.1],...
    [1 mx 1 my mz-20 mz-18 0],...
    [1 mx 1 my mz-23 mz-21 -0.1]); % 5 layer